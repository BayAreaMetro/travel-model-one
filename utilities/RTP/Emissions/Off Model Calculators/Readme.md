## Off-model calculation

Travel Model One is not sensitive to the full range of policies MTC and ABAG may choose to pursue in RTP. Marketing and education campaigns, as well as non-capacity-increasing transportation investments likebikeshare programs, are examples of strategies with the potential to change behavior in ways that result in reduced vehicle emissions. Travel Model 1.6 and EMFAC do not estimate reductions in emissions in response to these types of changes in traveler behavior. As such, “off-model” approaches are used to quantify the GHG reduction benefits of these important climate initiatives.

The off-model calculation process has been integrated into the Travel Model One run flow. In a standard model run ([RunModel.bat](https://github.com/BayAreaMetro/travel-model-one/blob/08fe2ce9fa9f593ced2b450581b7c098b42de7d7/model-files/RunModel.bat#L427)), after the core model steps are completed, [RunOffmodel.bat](https://github.com/BayAreaMetro/travel-model-one/blob/v1.6.1_develop/utilities/RTP/RunOffmodel.bat) is called to implement the following two steps:

1. Run [offmodel_prep.py](offmodel_prep.py) to generate model data used as input in the off-model calculator.

2. Run [run_offmodel_calculators.py](run_offmodel_calculators.py) to create off-model calculation Excel worbooks for a given run set (including a 2035 run and a 2050 run). In this step, a copy of the template workbook is made and the model data is populated into the respective sheets. The templates contain off-model calculation methodology, assumptions, and calculation steps for each off-model calculator.

The last step is to summarize off-model calculation results. The Excel workbooks created by `run_offmodel_calculators.py` need to be refreshed to trigger the calculation. The modeling servers cannot install the python package required for auto-refreshing. Therefore, the step of refreshing the workbooks and summarizing off-model calculation results is done when the output of multiple model runs are extracted for Tableau visualization. The model output extraction script [copyFilesAcrossScenarios.py](https://github.com/BayAreaMetro/travel-model-one/blob/08fe2ce9fa9f593ced2b450581b7c098b42de7d7/utilities/CoreSummaries/copyFilesAcrossScenarios.py#L173) does this by calling [extract_offmodel_results.py](extract_offmodel_results.py).
