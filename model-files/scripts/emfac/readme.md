[RunPrepareEmfac.bat](../../RunPrepareEmfac.bat)

This batch job processes three types of activity data (by county) for input into EMFAC to run in Burden mode 
and calculating regional on-road emission inventories.  The three types of activity data (all by county) that will 
be inputted are: (1) vehicle speed distribution files (for passenger vehicle types only); (2) vmt files by time of 
day and fuel type; (3) vehicle population files by vehicle type and fuel type.

There are five scripts/steps that produce the activity data inputted into EMFAC. 

Step (1) [BetweenZonesVMT.py](BetweenZonesVMT.py)

This script extracts link level VMT and speeds for the 13 ARB speed cohorts.
This generic script forecast year run applies for all 5 timeperiods.      

Step (2) [CreateSpeedBinsWithinZones.job](CreateSpeedBinsWithinZones.job)

This script - a) extracts intrazonal level VMT and speeds; and b) extracts total daily trips for the 13 ARB speed cohorts. This generic script forecast year run also applies for all 5 timeperiods.      

Step (3) [emfac_pre.py](emfac_prep.py)

This script reads the files generated by the previous two scripts, and 
* calculates the hourly VMT fractions by speed bin and subarea;
* rescales VMT by vehicle technology to the Travel Model VMT total (using the default vehicle technology proportions in the default EMFAC template);
* outputs an excel file that is in the format of an EMFAC "custom activity template".

The custom activity template serves as an input to EMFAC.
